{"remainingRequest":"/Users/coryhack/repSteps-recorder/node_modules/thread-loader/dist/cjs.js!/Users/coryhack/repSteps-recorder/node_modules/babel-loader/lib/index.js!/Users/coryhack/repSteps-recorder/node_modules/eslint-loader/index.js??ref--13-0!/Users/coryhack/repSteps-recorder/src/content-scripts/controller.js","dependencies":[{"path":"/Users/coryhack/repSteps-recorder/src/content-scripts/controller.js","mtime":1642800781933},{"path":"/Users/coryhack/repSteps-recorder/node_modules/cache-loader/dist/cjs.js","mtime":1643048371315},{"path":"/Users/coryhack/repSteps-recorder/node_modules/thread-loader/dist/cjs.js","mtime":1643048371203},{"path":"/Users/coryhack/repSteps-recorder/node_modules/babel-loader/lib/index.js","mtime":1643048374140},{"path":"/Users/coryhack/repSteps-recorder/node_modules/eslint-loader/index.js","mtime":1643048371599}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIi9Vc2Vycy9jb3J5aGFjay9yZXBTdGVwcy1yZWNvcmRlci9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vYXN5bmNUb0dlbmVyYXRvciI7CmltcG9ydCBfY2xhc3NDYWxsQ2hlY2sgZnJvbSAiL1VzZXJzL2NvcnloYWNrL3JlcFN0ZXBzLXJlY29yZGVyL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jbGFzc0NhbGxDaGVjayI7CmltcG9ydCBfY3JlYXRlQ2xhc3MgZnJvbSAiL1VzZXJzL2NvcnloYWNrL3JlcFN0ZXBzLXJlY29yZGVyL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jcmVhdGVDbGFzcyI7CmltcG9ydCAicmVnZW5lcmF0b3ItcnVudGltZS9ydW50aW1lLmpzIjsKaW1wb3J0IHsgb3ZlcmxheUFjdGlvbnMgfSBmcm9tICdAL21vZHVsZXMvb3ZlcmxheS9jb25zdGFudHMnOwppbXBvcnQgeyBwb3B1cEFjdGlvbnMsIHJlY29yZGluZ0NvbnRyb2xzLCBpc0RhcmtNb2RlIH0gZnJvbSAnQC9zZXJ2aWNlcy9jb25zdGFudHMnOwppbXBvcnQgc3RvcmFnZSBmcm9tICdAL3NlcnZpY2VzL3N0b3JhZ2UnOwppbXBvcnQgYnJvd3NlciBmcm9tICdAL3NlcnZpY2VzL2Jyb3dzZXInOwppbXBvcnQgU2hvb3RlciBmcm9tICdAL21vZHVsZXMvc2hvb3Rlcic7Cgp2YXIgSGVhZGxlc3NDb250cm9sbGVyID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICBmdW5jdGlvbiBIZWFkbGVzc0NvbnRyb2xsZXIoX3JlZikgewogICAgdmFyIG92ZXJsYXkgPSBfcmVmLm92ZXJsYXksCiAgICAgICAgcmVjb3JkZXIgPSBfcmVmLnJlY29yZGVyLAogICAgICAgIHN0b3JlID0gX3JlZi5zdG9yZTsKCiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgSGVhZGxlc3NDb250cm9sbGVyKTsKCiAgICB0aGlzLmJhY2tncm91bmRMaXN0ZW5lciA9IG51bGw7CiAgICB0aGlzLnN0b3JlID0gc3RvcmU7CiAgICB0aGlzLnNob290ZXIgPSBudWxsOwogICAgdGhpcy5vdmVybGF5ID0gb3ZlcmxheTsKICAgIHRoaXMucmVjb3JkZXIgPSByZWNvcmRlcjsKICB9CgogIF9jcmVhdGVDbGFzcyhIZWFkbGVzc0NvbnRyb2xsZXIsIFt7CiAgICBrZXk6ICJpbml0IiwKICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfaW5pdCA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZSgpIHsKICAgICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgICB2YXIgX3lpZWxkJHN0b3JhZ2UkZ2V0LCBvcHRpb25zLCBkYXJrTW9kZSwgX3JlZjIsIGRhdGFBdHRyaWJ1dGU7CgogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAyOwogICAgICAgICAgICAgICAgcmV0dXJuIHN0b3JhZ2UuZ2V0KFsnb3B0aW9ucyddKTsKCiAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgX3lpZWxkJHN0b3JhZ2UkZ2V0ID0gX2NvbnRleHQuc2VudDsKICAgICAgICAgICAgICAgIG9wdGlvbnMgPSBfeWllbGQkc3RvcmFnZSRnZXQub3B0aW9uczsKICAgICAgICAgICAgICAgIGRhcmtNb2RlID0gb3B0aW9ucyAmJiBvcHRpb25zLmV4dGVuc2lvbiA/IG9wdGlvbnMuZXh0ZW5zaW9uLmRhcmtNb2RlIDogaXNEYXJrTW9kZSgpOwogICAgICAgICAgICAgICAgX3JlZjIgPSBvcHRpb25zID8gb3B0aW9ucy5jb2RlIDoge30sIGRhdGFBdHRyaWJ1dGUgPSBfcmVmMi5kYXRhQXR0cmlidXRlOwogICAgICAgICAgICAgICAgdGhpcy5zdG9yZS5jb21taXQoJ3NldERhcmtNb2RlJywgZGFya01vZGUpOwogICAgICAgICAgICAgICAgdGhpcy5zdG9yZS5jb21taXQoJ3NldERhdGFBdHRyaWJ1dGUnLCBkYXRhQXR0cmlidXRlKTsKICAgICAgICAgICAgICAgIHRoaXMucmVjb3JkZXIuaW5pdChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcy5saXN0ZW5CYWNrZ3JvdW5kTWVzc2FnZXMoKTsKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICBjYXNlIDk6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlLCB0aGlzKTsKICAgICAgfSkpOwoKICAgICAgZnVuY3Rpb24gaW5pdCgpIHsKICAgICAgICByZXR1cm4gX2luaXQuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIGluaXQ7CiAgICB9KCkKICB9LCB7CiAgICBrZXk6ICJsaXN0ZW5CYWNrZ3JvdW5kTWVzc2FnZXMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGxpc3RlbkJhY2tncm91bmRNZXNzYWdlcygpIHsKICAgICAgdGhpcy5iYWNrZ3JvdW5kTGlzdGVuZXIgPSB0aGlzLmJhY2tncm91bmRMaXN0ZW5lciB8fCB0aGlzLmhhbmRsZUJhY2tncm91bmRNZXNzYWdlcy5iaW5kKHRoaXMpOwogICAgICBjaHJvbWUucnVudGltZS5vbk1lc3NhZ2UuYWRkTGlzdGVuZXIodGhpcy5iYWNrZ3JvdW5kTGlzdGVuZXIpOwogICAgfQogIH0sIHsKICAgIGtleTogImhhbmRsZUJhY2tncm91bmRNZXNzYWdlcyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX2hhbmRsZUJhY2tncm91bmRNZXNzYWdlcyA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTIobXNnKSB7CiAgICAgICAgdmFyIF9tc2ckdmFsdWU7CgogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMiQoX2NvbnRleHQyKSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0Mi5wcmV2ID0gX2NvbnRleHQyLm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBpZiAobXNnICE9PSBudWxsICYmIG1zZyAhPT0gdm9pZCAwICYmIG1zZy5hY3Rpb24pIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAyOwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgIF9jb250ZXh0Mi50MCA9IG1zZy5hY3Rpb247CiAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IF9jb250ZXh0Mi50MCA9PT0gb3ZlcmxheUFjdGlvbnMuVE9HR0xFX1NDUkVFTlNIT1RfTU9ERSA/IDUgOiBfY29udGV4dDIudDAgPT09IG92ZXJsYXlBY3Rpb25zLlRPR0dMRV9TQ1JFRU5TSE9UX0NMSVBQRURfTU9ERSA/IDcgOiBfY29udGV4dDIudDAgPT09IG92ZXJsYXlBY3Rpb25zLkNMT1NFX1NDUkVFTlNIT1RfTU9ERSA/IDkgOiBfY29udGV4dDIudDAgPT09IG92ZXJsYXlBY3Rpb25zLlRPR0dMRV9PVkVSTEFZID8gMTEgOiBfY29udGV4dDIudDAgPT09IHBvcHVwQWN0aW9ucy5TVE9QID8gMTMgOiBfY29udGV4dDIudDAgPT09IHBvcHVwQWN0aW9ucy5QQVVTRSA/IDE1IDogX2NvbnRleHQyLnQwID09PSBwb3B1cEFjdGlvbnMuVU5fUEFVU0UgPyAxNyA6IF9jb250ZXh0Mi50MCA9PT0gJ0NPREUnID8gMTkgOiAyMzsKICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZVNjcmVlbnNob3QoZmFsc2UpOwogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5hYnJ1cHQoImJyZWFrIiwgMjMpOwoKICAgICAgICAgICAgICBjYXNlIDc6CiAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZVNjcmVlbnNob3QodHJ1ZSk7CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLmFicnVwdCgiYnJlYWsiLCAyMyk7CgogICAgICAgICAgICAgIGNhc2UgOToKICAgICAgICAgICAgICAgIHRoaXMuY2FuY2VsU2NyZWVuc2hvdCgpOwogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5hYnJ1cHQoImJyZWFrIiwgMjMpOwoKICAgICAgICAgICAgICBjYXNlIDExOgogICAgICAgICAgICAgICAgbXNnICE9PSBudWxsICYmIG1zZyAhPT0gdm9pZCAwICYmIChfbXNnJHZhbHVlID0gbXNnLnZhbHVlKSAhPT0gbnVsbCAmJiBfbXNnJHZhbHVlICE9PSB2b2lkIDAgJiYgX21zZyR2YWx1ZS5vcGVuID8gdGhpcy5vdmVybGF5Lm1vdW50KG1zZy52YWx1ZSkgOiB0aGlzLm92ZXJsYXkudW5tb3VudCgpOwogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5hYnJ1cHQoImJyZWFrIiwgMjMpOwoKICAgICAgICAgICAgICBjYXNlIDEzOgogICAgICAgICAgICAgICAgdGhpcy5zdG9yZS5jb21taXQoJ2Nsb3NlJyk7CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLmFicnVwdCgiYnJlYWsiLCAyMyk7CgogICAgICAgICAgICAgIGNhc2UgMTU6CiAgICAgICAgICAgICAgICB0aGlzLnN0b3JlLmNvbW1pdCgncGF1c2UnKTsKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuYWJydXB0KCJicmVhayIsIDIzKTsKCiAgICAgICAgICAgICAgY2FzZSAxNzoKICAgICAgICAgICAgICAgIHRoaXMuc3RvcmUuY29tbWl0KCd1bnBhdXNlJyk7CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLmFicnVwdCgiYnJlYWsiLCAyMyk7CgogICAgICAgICAgICAgIGNhc2UgMTk6CiAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDIxOwogICAgICAgICAgICAgICAgcmV0dXJuIGJyb3dzZXIuY29weVRvQ2xpcGJvYXJkKG1zZy52YWx1ZSk7CgogICAgICAgICAgICAgIGNhc2UgMjE6CiAgICAgICAgICAgICAgICB0aGlzLnN0b3JlLmNvbW1pdCgnc2hvd0NvcHknKTsKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuYWJydXB0KCJicmVhayIsIDIzKTsKCiAgICAgICAgICAgICAgY2FzZSAyMzoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlMiwgdGhpcyk7CiAgICAgIH0pKTsKCiAgICAgIGZ1bmN0aW9uIGhhbmRsZUJhY2tncm91bmRNZXNzYWdlcyhfeCkgewogICAgICAgIHJldHVybiBfaGFuZGxlQmFja2dyb3VuZE1lc3NhZ2VzLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH0KCiAgICAgIHJldHVybiBoYW5kbGVCYWNrZ3JvdW5kTWVzc2FnZXM7CiAgICB9KCkKICB9LCB7CiAgICBrZXk6ICJoYW5kbGVTY3JlZW5zaG90IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBoYW5kbGVTY3JlZW5zaG90KGlzQ2xpcHBlZCkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgIHRoaXMucmVjb3JkZXIuZGlzYWJsZUNsaWNrUmVjb3JkaW5nKCk7CiAgICAgIHRoaXMuc2hvb3RlciA9IG5ldyBTaG9vdGVyKHsKICAgICAgICBpc0NsaXBwZWQ6IGlzQ2xpcHBlZCwKICAgICAgICBzdG9yZTogdGhpcy5zdG9yZQogICAgICB9KTsKICAgICAgdGhpcy5zaG9vdGVyLmFkZENhbWVyYUljb24oKTsKICAgICAgdGhpcy5zdG9yZS5zdGF0ZS5zY3JlZW5zaG90TW9kZSA/IHRoaXMuc2hvb3Rlci5zdGFydFNjcmVlbnNob3RNb2RlKCkgOiB0aGlzLnNob290ZXIuc3RvcFNjcmVlbnNob3RNb2RlKCk7CiAgICAgIHRoaXMuc2hvb3Rlci5vbignY2xpY2snLCBmdW5jdGlvbiAoX3JlZjMpIHsKICAgICAgICB2YXIgc2VsZWN0b3IgPSBfcmVmMy5zZWxlY3RvcjsKCiAgICAgICAgX3RoaXMyLnN0b3JlLmNvbW1pdCgnc3RvcFNjcmVlbnNob3RNb2RlJyk7CgogICAgICAgIF90aGlzMi5zaG9vdGVyLnNob3dTY3JlZW5zaG90RWZmZWN0KCk7CgogICAgICAgIF90aGlzMi5yZWNvcmRlci5fc2VuZE1lc3NhZ2UoewogICAgICAgICAgY29udHJvbDogcmVjb3JkaW5nQ29udHJvbHMuR0VUX1NDUkVFTlNIT1QsCiAgICAgICAgICB2YWx1ZTogc2VsZWN0b3IKICAgICAgICB9KTsKCiAgICAgICAgX3RoaXMyLnJlY29yZGVyLmVuYWJsZUNsaWNrUmVjb3JkaW5nKCk7CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogImNhbmNlbFNjcmVlbnNob3QiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNhbmNlbFNjcmVlbnNob3QoKSB7CiAgICAgIGlmICghdGhpcy5zdG9yZS5zdGF0ZS5zY3JlZW5zaG90TW9kZSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdGhpcy5zdG9yZS5jb21taXQoJ3N0b3BTY3JlZW5zaG90TW9kZScpOwogICAgICB0aGlzLnJlY29yZGVyLmVuYWJsZUNsaWNrUmVjb3JkaW5nKCk7CiAgICB9CiAgfV0pOwoKICByZXR1cm4gSGVhZGxlc3NDb250cm9sbGVyOwp9KCk7CgpleHBvcnQgeyBIZWFkbGVzc0NvbnRyb2xsZXIgYXMgZGVmYXVsdCB9Ow=="},{"version":3,"sources":["/Users/coryhack/repSteps-recorder/src/content-scripts/controller.js"],"names":["overlayActions","popupActions","recordingControls","isDarkMode","storage","browser","Shooter","HeadlessController","overlay","recorder","store","backgroundListener","shooter","get","options","darkMode","extension","code","dataAttribute","commit","init","listenBackgroundMessages","handleBackgroundMessages","bind","chrome","runtime","onMessage","addListener","msg","action","TOGGLE_SCREENSHOT_MODE","TOGGLE_SCREENSHOT_CLIPPED_MODE","CLOSE_SCREENSHOT_MODE","TOGGLE_OVERLAY","STOP","PAUSE","UN_PAUSE","handleScreenshot","cancelScreenshot","value","open","mount","unmount","copyToClipboard","isClipped","disableClickRecording","addCameraIcon","state","screenshotMode","startScreenshotMode","stopScreenshotMode","on","selector","showScreenshotEffect","_sendMessage","control","GET_SCREENSHOT","enableClickRecording"],"mappings":"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","sourcesContent":["import { overlayActions } from '@/modules/overlay/constants'\nimport { popupActions, recordingControls, isDarkMode } from '@/services/constants'\n\nimport storage from '@/services/storage'\nimport browser from '@/services/browser'\n\nimport Shooter from '@/modules/shooter'\n\nexport default class HeadlessController {\n  constructor({ overlay, recorder, store }) {\n    this.backgroundListener = null\n\n    this.store = store\n    this.shooter = null\n    this.overlay = overlay\n    this.recorder = recorder\n  }\n\n  async init() {\n    const { options } = await storage.get(['options'])\n\n    const darkMode = options && options.extension ? options.extension.darkMode : isDarkMode()\n    const { dataAttribute } = options ? options.code : {}\n\n    this.store.commit('setDarkMode', darkMode)\n    this.store.commit('setDataAttribute', dataAttribute)\n\n    this.recorder.init(() => this.listenBackgroundMessages())\n  }\n\n  listenBackgroundMessages() {\n    this.backgroundListener = this.backgroundListener || this.handleBackgroundMessages.bind(this)\n    chrome.runtime.onMessage.addListener(this.backgroundListener)\n  }\n\n  async handleBackgroundMessages(msg) {\n    if (!msg?.action) {\n      return\n    }\n\n    switch (msg.action) {\n      case overlayActions.TOGGLE_SCREENSHOT_MODE:\n        this.handleScreenshot(false)\n        break\n\n      case overlayActions.TOGGLE_SCREENSHOT_CLIPPED_MODE:\n        this.handleScreenshot(true)\n        break\n\n      case overlayActions.CLOSE_SCREENSHOT_MODE:\n        this.cancelScreenshot()\n        break\n\n      case overlayActions.TOGGLE_OVERLAY:\n        msg?.value?.open ? this.overlay.mount(msg.value) : this.overlay.unmount()\n        break\n\n      case popupActions.STOP:\n        this.store.commit('close')\n        break\n\n      case popupActions.PAUSE:\n        this.store.commit('pause')\n        break\n\n      case popupActions.UN_PAUSE:\n        this.store.commit('unpause')\n        break\n\n      case 'CODE':\n        await browser.copyToClipboard(msg.value)\n        this.store.commit('showCopy')\n        break\n    }\n  }\n\n  handleScreenshot(isClipped) {\n    this.recorder.disableClickRecording()\n    this.shooter = new Shooter({ isClipped, store: this.store })\n\n    this.shooter.addCameraIcon()\n\n    this.store.state.screenshotMode\n      ? this.shooter.startScreenshotMode()\n      : this.shooter.stopScreenshotMode()\n\n    this.shooter.on('click', ({ selector }) => {\n      this.store.commit('stopScreenshotMode')\n\n      this.shooter.showScreenshotEffect()\n      this.recorder._sendMessage({ control: recordingControls.GET_SCREENSHOT, value: selector })\n      this.recorder.enableClickRecording()\n    })\n  }\n\n  cancelScreenshot() {\n    if (!this.store.state.screenshotMode) {\n      return\n    }\n\n    this.store.commit('stopScreenshotMode')\n    this.recorder.enableClickRecording()\n  }\n}\n"]}]}
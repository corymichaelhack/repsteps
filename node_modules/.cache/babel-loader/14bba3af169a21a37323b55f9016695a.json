{"remainingRequest":"/Users/coryhack/headless-recorder/node_modules/babel-loader/lib/index.js!/Users/coryhack/headless-recorder/node_modules/eslint-loader/index.js??ref--13-0!/Users/coryhack/headless-recorder/src/background/index.js","dependencies":[{"path":"/Users/coryhack/headless-recorder/src/background/index.js","mtime":1644512622980},{"path":"/Users/coryhack/headless-recorder/node_modules/cache-loader/dist/cjs.js","mtime":1643048371315},{"path":"/Users/coryhack/headless-recorder/node_modules/babel-loader/lib/index.js","mtime":1643048374140},{"path":"/Users/coryhack/headless-recorder/node_modules/eslint-loader/index.js","mtime":1643048371599}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIi9Vc2Vycy9jb3J5aGFjay9oZWFkbGVzcy1yZWNvcmRlci9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vYXN5bmNUb0dlbmVyYXRvciI7CmltcG9ydCBfY2xhc3NDYWxsQ2hlY2sgZnJvbSAiL1VzZXJzL2NvcnloYWNrL2hlYWRsZXNzLXJlY29yZGVyL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jbGFzc0NhbGxDaGVjayI7CmltcG9ydCBfY3JlYXRlQ2xhc3MgZnJvbSAiL1VzZXJzL2NvcnloYWNrL2hlYWRsZXNzLXJlY29yZGVyL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jcmVhdGVDbGFzcyI7CmltcG9ydCAiL1VzZXJzL2NvcnloYWNrL2hlYWRsZXNzLXJlY29yZGVyL25vZGVfbW9kdWxlcy9jb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuaXRlcmF0b3IuanMiOwppbXBvcnQgIi9Vc2Vycy9jb3J5aGFjay9oZWFkbGVzcy1yZWNvcmRlci9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL2VzLnByb21pc2UuanMiOwppbXBvcnQgIi9Vc2Vycy9jb3J5aGFjay9oZWFkbGVzcy1yZWNvcmRlci9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC5hc3NpZ24uanMiOwppbXBvcnQgIi9Vc2Vycy9jb3J5aGFjay9oZWFkbGVzcy1yZWNvcmRlci9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL2VzLnByb21pc2UuZmluYWxseS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmcuanMiOwppbXBvcnQgInJlZ2VuZXJhdG9yLXJ1bnRpbWUvcnVudGltZS5qcyI7CmltcG9ydCBiYWRnZSBmcm9tICdAL3NlcnZpY2VzL2JhZGdlJzsKaW1wb3J0IGJyb3dzZXIgZnJvbSAnQC9zZXJ2aWNlcy9icm93c2VyJzsKaW1wb3J0IHN0b3JhZ2UgZnJvbSAnQC9zZXJ2aWNlcy9zdG9yYWdlJzsKaW1wb3J0IHsgcG9wdXBBY3Rpb25zLCByZWNvcmRpbmdDb250cm9scyB9IGZyb20gJ0Avc2VydmljZXMvY29uc3RhbnRzJzsKaW1wb3J0IHsgb3ZlcmxheUFjdGlvbnMgfSBmcm9tICdAL21vZHVsZXMvb3ZlcmxheS9jb25zdGFudHMnOwppbXBvcnQgeyBoZWFkbGVzc0FjdGlvbnMgfSBmcm9tICdAL21vZHVsZXMvY29kZS1nZW5lcmF0b3IvY29uc3RhbnRzJzsKaW1wb3J0IENvZGVHZW5lcmF0b3IgZnJvbSAnQC9tb2R1bGVzL2NvZGUtZ2VuZXJhdG9yJzsKCnZhciBCYWNrZ3JvdW5kID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICBmdW5jdGlvbiBCYWNrZ3JvdW5kKCkgewogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEJhY2tncm91bmQpOwoKICAgIHRoaXMuX3JlY29yZGluZyA9IFtdOwogICAgdGhpcy5fYm91bmRlZE1lc3NhZ2VIYW5kbGVyID0gbnVsbDsKICAgIHRoaXMuX2JvdW5kZWROYXZpZ2F0aW9uSGFuZGxlciA9IG51bGw7CiAgICB0aGlzLl9ib3VuZGVkV2FpdEhhbmRsZXIgPSBudWxsOwogICAgdGhpcy5vdmVybGF5SGFuZGxlciA9IG51bGw7CiAgICB0aGlzLl9iYWRnZVN0YXRlID0gJyc7CiAgICB0aGlzLl9pc1BhdXNlZCA9IGZhbHNlOwogICAgdGhpcy5fYm91bmRlZE1lbnVIYW5kbGVyID0gbnVsbDsgLy8gU29tZSBldmVudHMgYXJlIHNlbnQgZG91YmxlIG9uIHBhZ2UgbmF2aWdhdGlvbnMgdG8gc2ltcGxpZnkgdGhlIGV2ZW50IHJlY29yZGVyLgogICAgLy8gV2Uga2VlcCBzb21lIHNpbXBsZSBzdGF0ZSB0byBkaXNyZWdhcmQgZXZlbnRzIGlmIG5lZWRlZC4KCiAgICB0aGlzLl9oYXNHb3RvID0gZmFsc2U7CiAgICB0aGlzLl9oYXNWaWV3UG9ydCA9IGZhbHNlOwogIH0KCiAgX2NyZWF0ZUNsYXNzKEJhY2tncm91bmQsIFt7CiAgICBrZXk6ICJpbml0IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBpbml0KCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgY2hyb21lLmV4dGVuc2lvbi5vbkNvbm5lY3QuYWRkTGlzdGVuZXIoZnVuY3Rpb24gKHBvcnQpIHsKICAgICAgICBwb3J0Lm9uTWVzc2FnZS5hZGRMaXN0ZW5lcihmdW5jdGlvbiAobXNnKSB7CiAgICAgICAgICByZXR1cm4gX3RoaXMuaGFuZGxlUG9wdXBNZXNzYWdlKG1zZyk7CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogInN0YXJ0IiwKICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfc3RhcnQgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoKSB7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDI7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5jbGVhblVwKCk7CgogICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgIHRoaXMuX2JhZGdlU3RhdGUgPSAnJzsKICAgICAgICAgICAgICAgIHRoaXMuX2hhc0dvdG8gPSBmYWxzZTsKICAgICAgICAgICAgICAgIHRoaXMuX2hhc1ZpZXdQb3J0ID0gZmFsc2U7CiAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gNzsKICAgICAgICAgICAgICAgIHJldHVybiBicm93c2VyLmluamVjdENvbnRlbnRTY3JpcHQoKTsKCiAgICAgICAgICAgICAgY2FzZSA3OgogICAgICAgICAgICAgICAgdGhpcy50b2dnbGVPdmVybGF5KHsKICAgICAgICAgICAgICAgICAgb3BlbjogdHJ1ZSwKICAgICAgICAgICAgICAgICAgY2xlYXI6IHRydWUKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgdGhpcy5fYm91bmRlZE1lc3NhZ2VIYW5kbGVyID0gdGhpcy5oYW5kbGVNZXNzYWdlLmJpbmQodGhpcyk7CiAgICAgICAgICAgICAgICB0aGlzLl9ib3VuZGVkTmF2aWdhdGlvbkhhbmRsZXIgPSB0aGlzLmhhbmRsZU5hdmlnYXRpb24uYmluZCh0aGlzKTsKCiAgICAgICAgICAgICAgICB0aGlzLl9ib3VuZGVkV2FpdEhhbmRsZXIgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgIHJldHVybiBiYWRnZS53YWl0KCk7CiAgICAgICAgICAgICAgICB9OwoKICAgICAgICAgICAgICAgIHRoaXMub3ZlcmxheUhhbmRsZXIgPSB0aGlzLmhhbmRsZU92ZXJsYXlNZXNzYWdlLmJpbmQodGhpcyk7IC8vIGNocm9tZS5jb250ZXh0TWVudXMuY3JlYXRlKHsKICAgICAgICAgICAgICAgIC8vICAgaWQ6IHRoaXMuX21lbnVJZCwKICAgICAgICAgICAgICAgIC8vICAgdGl0bGU6ICdIZWFkbGVzcyBSZWNvcmRlcicsCiAgICAgICAgICAgICAgICAvLyAgIGNvbnRleHRzOiBbJ2FsbCddLAogICAgICAgICAgICAgICAgLy8gfSkKICAgICAgICAgICAgICAgIC8vIGNocm9tZS5jb250ZXh0TWVudXMuY3JlYXRlKHsKICAgICAgICAgICAgICAgIC8vICAgaWQ6IHRoaXMuX21lbnVJZCArICdTRUxFQ1RPUicsCiAgICAgICAgICAgICAgICAvLyAgIHRpdGxlOiAnQ29weSBTZWxlY3RvcicsCiAgICAgICAgICAgICAgICAvLyAgIHBhcmVudElkOiB0aGlzLl9tZW51SWQsCiAgICAgICAgICAgICAgICAvLyAgIGNvbnRleHRzOiBbJ2FsbCddLAogICAgICAgICAgICAgICAgLy8gfSkKICAgICAgICAgICAgICAgIC8vIHRoaXMuX2JvdW5kZWRNZW51SGFuZGxlciA9IHRoaXMuaGFuZGxlTWVudUludGVyYWN0aW9uLmJpbmQodGhpcykKICAgICAgICAgICAgICAgIC8vIGNocm9tZS5jb250ZXh0TWVudXMub25DbGlja2VkLmFkZExpc3RlbmVyKHRoaXMuX2JvdW5kZWRNZW51SGFuZGxlcikKCiAgICAgICAgICAgICAgICBjaHJvbWUucnVudGltZS5vbk1lc3NhZ2UuYWRkTGlzdGVuZXIodGhpcy5fYm91bmRlZE1lc3NhZ2VIYW5kbGVyKTsKICAgICAgICAgICAgICAgIGNocm9tZS5ydW50aW1lLm9uTWVzc2FnZS5hZGRMaXN0ZW5lcih0aGlzLm92ZXJsYXlIYW5kbGVyKTsKICAgICAgICAgICAgICAgIGNocm9tZS53ZWJOYXZpZ2F0aW9uLm9uQ29tcGxldGVkLmFkZExpc3RlbmVyKHRoaXMuX2JvdW5kZWROYXZpZ2F0aW9uSGFuZGxlcik7CiAgICAgICAgICAgICAgICBjaHJvbWUud2ViTmF2aWdhdGlvbi5vbkJlZm9yZU5hdmlnYXRlLmFkZExpc3RlbmVyKHRoaXMuX2JvdW5kZWRXYWl0SGFuZGxlcik7CiAgICAgICAgICAgICAgICBiYWRnZS5zdGFydCgpOwoKICAgICAgICAgICAgICBjYXNlIDE3OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZSwgdGhpcyk7CiAgICAgIH0pKTsKCiAgICAgIGZ1bmN0aW9uIHN0YXJ0KCkgewogICAgICAgIHJldHVybiBfc3RhcnQuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHN0YXJ0OwogICAgfSgpCiAgfSwgewogICAga2V5OiAic3RvcCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc3RvcCgpIHsKICAgICAgdGhpcy5fYmFkZ2VTdGF0ZSA9IHRoaXMuX3JlY29yZGluZy5sZW5ndGggPiAwID8gJzEnIDogJyc7CiAgICAgIGNocm9tZS5ydW50aW1lLm9uTWVzc2FnZS5yZW1vdmVMaXN0ZW5lcih0aGlzLl9ib3VuZGVkTWVzc2FnZUhhbmRsZXIpOwogICAgICBjaHJvbWUud2ViTmF2aWdhdGlvbi5vbkNvbXBsZXRlZC5yZW1vdmVMaXN0ZW5lcih0aGlzLl9ib3VuZGVkTmF2aWdhdGlvbkhhbmRsZXIpOwogICAgICBjaHJvbWUud2ViTmF2aWdhdGlvbi5vbkJlZm9yZU5hdmlnYXRlLnJlbW92ZUxpc3RlbmVyKHRoaXMuX2JvdW5kZWRXYWl0SGFuZGxlcik7IC8vIGNocm9tZS5jb250ZXh0TWVudXMub25DbGlja2VkLnJlbW92ZUxpc3RlbmVyKHRoaXMuX2JvdW5kZWRNZW51SGFuZGxlcikKCiAgICAgIGJhZGdlLnN0b3AodGhpcy5fYmFkZ2VTdGF0ZSk7CiAgICAgIHN0b3JhZ2Uuc2V0KHsKICAgICAgICByZWNvcmRpbmc6IHRoaXMuX3JlY29yZGluZwogICAgICB9KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJwYXVzZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcGF1c2UoKSB7CiAgICAgIGJhZGdlLnBhdXNlKCk7CiAgICAgIHRoaXMuX2lzUGF1c2VkID0gdHJ1ZTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJ1blBhdXNlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiB1blBhdXNlKCkgewogICAgICBiYWRnZS5zdGFydCgpOwogICAgICB0aGlzLl9pc1BhdXNlZCA9IGZhbHNlOwogICAgfQogIH0sIHsKICAgIGtleTogImNsZWFuVXAiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNsZWFuVXAoKSB7CiAgICAgIHRoaXMuX3JlY29yZGluZyA9IFtdOwogICAgICB0aGlzLl9pc1BhdXNlZCA9IGZhbHNlOwogICAgICBiYWRnZS5yZXNldCgpOwogICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHsKICAgICAgICBjaHJvbWUuc3RvcmFnZS5sb2NhbC5yZW1vdmUoJ3JlY29yZGluZycsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHJldHVybiByZXNvbHZlKCk7CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogInJlY29yZEN1cnJlbnRWaWV3cG9ydFNpemUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlY29yZEN1cnJlbnRWaWV3cG9ydFNpemUodmFsdWUpIHsKICAgICAgaWYgKCF0aGlzLl9oYXNWaWV3UG9ydCkgewogICAgICAgIHRoaXMuaGFuZGxlTWVzc2FnZSh7CiAgICAgICAgICBzZWxlY3RvcjogdW5kZWZpbmVkLAogICAgICAgICAgdmFsdWU6IHZhbHVlLAogICAgICAgICAgYWN0aW9uOiBoZWFkbGVzc0FjdGlvbnMuVklFV1BPUlQKICAgICAgICB9KTsKICAgICAgICB0aGlzLl9oYXNWaWV3UG9ydCA9IHRydWU7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICJyZWNvcmROYXZpZ2F0aW9uIiwKICAgIHZhbHVlOiBmdW5jdGlvbiByZWNvcmROYXZpZ2F0aW9uKGhyZWYpIHsKICAgICAgdGhpcy5oYW5kbGVNZXNzYWdlKHsKICAgICAgICBzZWxlY3RvcjogdW5kZWZpbmVkLAogICAgICAgIHZhbHVlOiB1bmRlZmluZWQsCiAgICAgICAgYWN0aW9uOiBoZWFkbGVzc0FjdGlvbnMuTkFWSUdBVElPTiwKICAgICAgICBocmVmOiBocmVmCiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogInJlY29yZFNjcmVlbnNob3QiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlY29yZFNjcmVlbnNob3QodmFsdWUpIHsKICAgICAgdGhpcy5oYW5kbGVNZXNzYWdlKHsKICAgICAgICBzZWxlY3RvcjogdW5kZWZpbmVkLAogICAgICAgIHZhbHVlOiB2YWx1ZSwKICAgICAgICBhY3Rpb246IGhlYWRsZXNzQWN0aW9ucy5TQ1JFRU5TSE9UCiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogImhhbmRsZU1lc3NhZ2UiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGhhbmRsZU1lc3NhZ2UobXNnLCBzZW5kZXIpIHsKICAgICAgaWYgKG1zZy5jb250cm9sKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuaGFuZGxlUmVjb3JkaW5nTWVzc2FnZShtc2csIHNlbmRlcik7CiAgICAgIH0KCiAgICAgIGlmIChtc2cudHlwZSA9PT0gJ1NJR05fQ09OTkVDVCcpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGlmICghdGhpcy5faXNQYXVzZWQpIHsKICAgICAgICB0aGlzLl9yZWNvcmRpbmcucHVzaChtc2cpOwoKICAgICAgICBzdG9yYWdlLnNldCh7CiAgICAgICAgICByZWNvcmRpbmc6IHRoaXMuX3JlY29yZGluZwogICAgICAgIH0pOwogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAiaGFuZGxlT3ZlcmxheU1lc3NhZ2UiLAogICAgdmFsdWU6IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIF9oYW5kbGVPdmVybGF5TWVzc2FnZSA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTIoX3JlZikgewogICAgICAgIHZhciBjb250cm9sLCBfeWllbGQkc3RvcmFnZSRnZXQsIF95aWVsZCRzdG9yYWdlJGdldCRvcCwgb3B0aW9ucywgZ2VuZXJhdG9yLCBjb2RlOwoKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTIkKF9jb250ZXh0MikgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDIucHJldiA9IF9jb250ZXh0Mi5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgY29udHJvbCA9IF9yZWYuY29udHJvbDsKCiAgICAgICAgICAgICAgICBpZiAoY29udHJvbCkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDM7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgICAgaWYgKGNvbnRyb2wgPT09IG92ZXJsYXlBY3Rpb25zLlJFU1RBUlQpIHsKICAgICAgICAgICAgICAgICAgY2hyb21lLnN0b3JhZ2UubG9jYWwuc2V0KHsKICAgICAgICAgICAgICAgICAgICByZXN0YXJ0OiB0cnVlCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICBjaHJvbWUuc3RvcmFnZS5sb2NhbC5zZXQoewogICAgICAgICAgICAgICAgICAgIGNsZWFyOiBmYWxzZQogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgY2hyb21lLnJ1bnRpbWUub25NZXNzYWdlLnJlbW92ZUxpc3RlbmVyKHRoaXMub3ZlcmxheUhhbmRsZXIpOwogICAgICAgICAgICAgICAgICB0aGlzLnN0b3AoKTsKICAgICAgICAgICAgICAgICAgdGhpcy5jbGVhblVwKCk7CiAgICAgICAgICAgICAgICAgIHRoaXMuc3RhcnQoKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBpZiAoY29udHJvbCA9PT0gb3ZlcmxheUFjdGlvbnMuQ0xPU0UpIHsKICAgICAgICAgICAgICAgICAgdGhpcy50b2dnbGVPdmVybGF5KCk7CiAgICAgICAgICAgICAgICAgIGNocm9tZS5ydW50aW1lLm9uTWVzc2FnZS5yZW1vdmVMaXN0ZW5lcih0aGlzLm92ZXJsYXlIYW5kbGVyKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBpZiAoIShjb250cm9sID09PSBvdmVybGF5QWN0aW9ucy5DT1BZKSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDE0OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDg7CiAgICAgICAgICAgICAgICByZXR1cm4gc3RvcmFnZS5nZXQoJ29wdGlvbnMnKTsKCiAgICAgICAgICAgICAgY2FzZSA4OgogICAgICAgICAgICAgICAgX3lpZWxkJHN0b3JhZ2UkZ2V0ID0gX2NvbnRleHQyLnNlbnQ7CiAgICAgICAgICAgICAgICBfeWllbGQkc3RvcmFnZSRnZXQkb3AgPSBfeWllbGQkc3RvcmFnZSRnZXQub3B0aW9uczsKICAgICAgICAgICAgICAgIG9wdGlvbnMgPSBfeWllbGQkc3RvcmFnZSRnZXQkb3AgPT09IHZvaWQgMCA/IHt9IDogX3lpZWxkJHN0b3JhZ2UkZ2V0JG9wOwogICAgICAgICAgICAgICAgZ2VuZXJhdG9yID0gbmV3IENvZGVHZW5lcmF0b3Iob3B0aW9ucyk7CiAgICAgICAgICAgICAgICBjb2RlID0gZ2VuZXJhdG9yLmdlbmVyYXRlKHRoaXMuX3JlY29yZGluZyk7CiAgICAgICAgICAgICAgICBicm93c2VyLnNlbmRUYWJNZXNzYWdlKHsKICAgICAgICAgICAgICAgICAgYWN0aW9uOiAnQ09ERScsCiAgICAgICAgICAgICAgICAgIHZhbHVlOiBjb2RlLnJlcFN0ZXBzCiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgY2FzZSAxNDoKICAgICAgICAgICAgICAgIGlmIChjb250cm9sID09PSBvdmVybGF5QWN0aW9ucy5TVE9QKSB7CiAgICAgICAgICAgICAgICAgIGNocm9tZS5zdG9yYWdlLmxvY2FsLnNldCh7CiAgICAgICAgICAgICAgICAgICAgY2xlYXI6IHRydWUKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgIGNocm9tZS5zdG9yYWdlLmxvY2FsLnNldCh7CiAgICAgICAgICAgICAgICAgICAgcGF1c2U6IGZhbHNlCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICBjaHJvbWUuc3RvcmFnZS5sb2NhbC5zZXQoewogICAgICAgICAgICAgICAgICAgIHJlc3RhcnQ6IGZhbHNlCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICB0aGlzLnN0b3AoKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBpZiAoY29udHJvbCA9PT0gb3ZlcmxheUFjdGlvbnMuVU5QQVVTRSkgewogICAgICAgICAgICAgICAgICBjaHJvbWUuc3RvcmFnZS5sb2NhbC5zZXQoewogICAgICAgICAgICAgICAgICAgIHBhdXNlOiBmYWxzZQogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgdGhpcy51blBhdXNlKCk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgaWYgKGNvbnRyb2wgPT09IG92ZXJsYXlBY3Rpb25zLlBBVVNFKSB7CiAgICAgICAgICAgICAgICAgIGNocm9tZS5zdG9yYWdlLmxvY2FsLnNldCh7CiAgICAgICAgICAgICAgICAgICAgcGF1c2U6IHRydWUKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgIHRoaXMucGF1c2UoKTsKICAgICAgICAgICAgICAgIH0gLy8gVE9ETzogdGhlIG5leHQgMyBldmVudHMgZG8gbm90IG5lZWQgdG8gYmUgbGlzdGVuZWQgaW4gYmFja2dyb3VuZAogICAgICAgICAgICAgICAgLy8gY29udGVudCBzY3JpcHQgY29udHJvbGxlciwgc2hvdWxkIGJlIGFibGUgdG8gaGFuZGxlIHRoYXQgZGlyZWN0bHkgZnJvbSBvdmVybGF5CgoKICAgICAgICAgICAgICAgIGlmIChjb250cm9sID09PSBvdmVybGF5QWN0aW9ucy5DTElQUEVEX1NDUkVFTlNIT1QpIHsKICAgICAgICAgICAgICAgICAgYnJvd3Nlci5zZW5kVGFiTWVzc2FnZSh7CiAgICAgICAgICAgICAgICAgICAgYWN0aW9uOiBvdmVybGF5QWN0aW9ucy5UT0dHTEVfU0NSRUVOU0hPVF9DTElQUEVEX01PREUKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgaWYgKGNvbnRyb2wgPT09IG92ZXJsYXlBY3Rpb25zLkZVTExfU0NSRUVOU0hPVCkgewogICAgICAgICAgICAgICAgICBicm93c2VyLnNlbmRUYWJNZXNzYWdlKHsKICAgICAgICAgICAgICAgICAgICBhY3Rpb246IG92ZXJsYXlBY3Rpb25zLlRPR0dMRV9TQ1JFRU5TSE9UX01PREUKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgaWYgKGNvbnRyb2wgPT09IG92ZXJsYXlBY3Rpb25zLkFCT1JUX1NDUkVFTlNIT1QpIHsKICAgICAgICAgICAgICAgICAgYnJvd3Nlci5zZW5kVGFiTWVzc2FnZSh7CiAgICAgICAgICAgICAgICAgICAgYWN0aW9uOiBvdmVybGF5QWN0aW9ucy5DTE9TRV9TQ1JFRU5TSE9UX01PREUKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGNhc2UgMjA6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTIsIHRoaXMpOwogICAgICB9KSk7CgogICAgICBmdW5jdGlvbiBoYW5kbGVPdmVybGF5TWVzc2FnZShfeCkgewogICAgICAgIHJldHVybiBfaGFuZGxlT3ZlcmxheU1lc3NhZ2UuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIGhhbmRsZU92ZXJsYXlNZXNzYWdlOwogICAgfSgpCiAgfSwgewogICAga2V5OiAiaGFuZGxlUmVjb3JkaW5nTWVzc2FnZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gaGFuZGxlUmVjb3JkaW5nTWVzc2FnZShfcmVmMikgewogICAgICB2YXIgY29udHJvbCA9IF9yZWYyLmNvbnRyb2wsCiAgICAgICAgICBocmVmID0gX3JlZjIuaHJlZiwKICAgICAgICAgIHZhbHVlID0gX3JlZjIudmFsdWUsCiAgICAgICAgICBjb29yZGluYXRlcyA9IF9yZWYyLmNvb3JkaW5hdGVzOwoKICAgICAgaWYgKGNvbnRyb2wgPT09IHJlY29yZGluZ0NvbnRyb2xzLkVWRU5UX1JFQ09SREVSX1NUQVJURUQpIHsKICAgICAgICBiYWRnZS5zZXRUZXh0KHRoaXMuX2JhZGdlU3RhdGUpOwogICAgICB9CgogICAgICBpZiAoY29udHJvbCA9PT0gcmVjb3JkaW5nQ29udHJvbHMuR0VUX1ZJRVdQT1JUX1NJWkUpIHsKICAgICAgICB0aGlzLnJlY29yZEN1cnJlbnRWaWV3cG9ydFNpemUoY29vcmRpbmF0ZXMpOwogICAgICB9CgogICAgICBpZiAoY29udHJvbCA9PT0gcmVjb3JkaW5nQ29udHJvbHMuR0VUX0NVUlJFTlRfVVJMKSB7CiAgICAgICAgdGhpcy5yZWNvcmROYXZpZ2F0aW9uKGhyZWYpOwogICAgICB9CgogICAgICBpZiAoY29udHJvbCA9PT0gcmVjb3JkaW5nQ29udHJvbHMuR0VUX1NDUkVFTlNIT1QpIHsKICAgICAgICB0aGlzLnJlY29yZFNjcmVlbnNob3QodmFsdWUpOwogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAiaGFuZGxlUG9wdXBNZXNzYWdlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBoYW5kbGVQb3B1cE1lc3NhZ2UobXNnKSB7CiAgICAgIGNvbnNvbGUubG9nKG1zZyk7CgogICAgICBpZiAoIW1zZy5hY3Rpb24pIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGlmIChtc2cuYWN0aW9uID09PSBwb3B1cEFjdGlvbnMuU1RBUlQpIHsKICAgICAgICB0aGlzLnN0YXJ0KCk7CiAgICAgIH0KCiAgICAgIGlmIChtc2cuYWN0aW9uID09PSBwb3B1cEFjdGlvbnMuU1RPUCkgewogICAgICAgIGJyb3dzZXIuc2VuZFRhYk1lc3NhZ2UoewogICAgICAgICAgYWN0aW9uOiBwb3B1cEFjdGlvbnMuU1RPUAogICAgICAgIH0pOwogICAgICAgIHRoaXMuc3RvcCgpOwogICAgICB9CgogICAgICBpZiAobXNnLmFjdGlvbiA9PT0gcG9wdXBBY3Rpb25zLkNMRUFOX1VQKSB7CiAgICAgICAgY2hyb21lLnJ1bnRpbWUub25NZXNzYWdlLnJlbW92ZUxpc3RlbmVyKHRoaXMub3ZlcmxheUhhbmRsZXIpOwogICAgICAgIG1zZy52YWx1ZSAmJiB0aGlzLnN0b3AoKTsKICAgICAgICB0aGlzLnRvZ2dsZU92ZXJsYXkoKTsKICAgICAgICB0aGlzLmNsZWFuVXAoKTsKICAgICAgfQoKICAgICAgaWYgKG1zZy5hY3Rpb24gPT09IHBvcHVwQWN0aW9ucy5QQVVTRSkgewogICAgICAgIGlmICghbXNnLnN0b3ApIHsKICAgICAgICAgIGJyb3dzZXIuc2VuZFRhYk1lc3NhZ2UoewogICAgICAgICAgICBhY3Rpb246IHBvcHVwQWN0aW9ucy5QQVVTRQogICAgICAgICAgfSk7CiAgICAgICAgfQoKICAgICAgICB0aGlzLnBhdXNlKCk7CiAgICAgIH0KCiAgICAgIGlmIChtc2cuYWN0aW9uID09PSBwb3B1cEFjdGlvbnMuVU5fUEFVU0UpIHsKICAgICAgICBpZiAoIW1zZy5zdG9wKSB7CiAgICAgICAgICBicm93c2VyLnNlbmRUYWJNZXNzYWdlKHsKICAgICAgICAgICAgYWN0aW9uOiBwb3B1cEFjdGlvbnMuVU5fUEFVU0UKICAgICAgICAgIH0pOwogICAgICAgIH0KCiAgICAgICAgdGhpcy51blBhdXNlKCk7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICJoYW5kbGVOYXZpZ2F0aW9uIiwKICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfaGFuZGxlTmF2aWdhdGlvbiA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTMoKSB7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUzJChfY29udGV4dDMpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQzLnByZXYgPSBfY29udGV4dDMubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIF9jb250ZXh0My5uZXh0ID0gMjsKICAgICAgICAgICAgICAgIHJldHVybiBicm93c2VyLmluamVjdENvbnRlbnRTY3JpcHQoKTsKCiAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgdGhpcy50b2dnbGVPdmVybGF5KHsKICAgICAgICAgICAgICAgICAgb3BlbjogdHJ1ZSwKICAgICAgICAgICAgICAgICAgcGF1c2U6IHRoaXMuX2lzUGF1c2VkCiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUzLCB0aGlzKTsKICAgICAgfSkpOwoKICAgICAgZnVuY3Rpb24gaGFuZGxlTmF2aWdhdGlvbigpIHsKICAgICAgICByZXR1cm4gX2hhbmRsZU5hdmlnYXRpb24uYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIGhhbmRsZU5hdmlnYXRpb247CiAgICB9KCkgLy8gVE9ETzogVXNlIGEgYmV0dGVyIG5hbWluZyBjb252ZW50aW9uIGZvciB0aGlzIGFyZ3VtZW50cwoKICB9LCB7CiAgICBrZXk6ICJ0b2dnbGVPdmVybGF5IiwKICAgIHZhbHVlOiBmdW5jdGlvbiB0b2dnbGVPdmVybGF5KCkgewogICAgICB2YXIgX3JlZjMgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IHt9LAogICAgICAgICAgX3JlZjMkb3BlbiA9IF9yZWYzLm9wZW4sCiAgICAgICAgICBvcGVuID0gX3JlZjMkb3BlbiA9PT0gdm9pZCAwID8gZmFsc2UgOiBfcmVmMyRvcGVuLAogICAgICAgICAgX3JlZjMkY2xlYXIgPSBfcmVmMy5jbGVhciwKICAgICAgICAgIGNsZWFyID0gX3JlZjMkY2xlYXIgPT09IHZvaWQgMCA/IGZhbHNlIDogX3JlZjMkY2xlYXIsCiAgICAgICAgICBfcmVmMyRwYXVzZSA9IF9yZWYzLnBhdXNlLAogICAgICAgICAgcGF1c2UgPSBfcmVmMyRwYXVzZSA9PT0gdm9pZCAwID8gZmFsc2UgOiBfcmVmMyRwYXVzZTsKCiAgICAgIGJyb3dzZXIuc2VuZFRhYk1lc3NhZ2UoewogICAgICAgIGFjdGlvbjogb3ZlcmxheUFjdGlvbnMuVE9HR0xFX09WRVJMQVksCiAgICAgICAgdmFsdWU6IHsKICAgICAgICAgIG9wZW46IG9wZW4sCiAgICAgICAgICBjbGVhcjogY2xlYXIsCiAgICAgICAgICBwYXVzZTogcGF1c2UKICAgICAgICB9CiAgICAgIH0pOwogICAgfQogIH1dKTsKCiAgcmV0dXJuIEJhY2tncm91bmQ7Cn0oKTsKCndpbmRvdy5oZWFkbGVzc1JlY29yZGVyID0gbmV3IEJhY2tncm91bmQoKTsKd2luZG93LmhlYWRsZXNzUmVjb3JkZXIuaW5pdCgpOw=="},null]}
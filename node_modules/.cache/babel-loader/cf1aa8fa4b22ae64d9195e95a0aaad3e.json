{"remainingRequest":"/Users/coryhack/headless-recorder/node_modules/babel-loader/lib/index.js!/Users/coryhack/headless-recorder/node_modules/eslint-loader/index.js??ref--13-0!/Users/coryhack/headless-recorder/src/background/index.js","dependencies":[{"path":"/Users/coryhack/headless-recorder/src/background/index.js","mtime":1642800781930},{"path":"/Users/coryhack/headless-recorder/node_modules/cache-loader/dist/cjs.js","mtime":1643048371315},{"path":"/Users/coryhack/headless-recorder/node_modules/babel-loader/lib/index.js","mtime":1643048374140},{"path":"/Users/coryhack/headless-recorder/node_modules/eslint-loader/index.js","mtime":1643048371599}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIi9Vc2Vycy9jb3J5aGFjay9oZWFkbGVzcy1yZWNvcmRlci9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vYXN5bmNUb0dlbmVyYXRvciI7CmltcG9ydCBfY2xhc3NDYWxsQ2hlY2sgZnJvbSAiL1VzZXJzL2NvcnloYWNrL2hlYWRsZXNzLXJlY29yZGVyL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jbGFzc0NhbGxDaGVjayI7CmltcG9ydCBfY3JlYXRlQ2xhc3MgZnJvbSAiL1VzZXJzL2NvcnloYWNrL2hlYWRsZXNzLXJlY29yZGVyL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jcmVhdGVDbGFzcyI7CmltcG9ydCAiL1VzZXJzL2NvcnloYWNrL2hlYWRsZXNzLXJlY29yZGVyL25vZGVfbW9kdWxlcy9jb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuaXRlcmF0b3IuanMiOwppbXBvcnQgIi9Vc2Vycy9jb3J5aGFjay9oZWFkbGVzcy1yZWNvcmRlci9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL2VzLnByb21pc2UuanMiOwppbXBvcnQgIi9Vc2Vycy9jb3J5aGFjay9oZWFkbGVzcy1yZWNvcmRlci9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC5hc3NpZ24uanMiOwppbXBvcnQgIi9Vc2Vycy9jb3J5aGFjay9oZWFkbGVzcy1yZWNvcmRlci9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL2VzLnByb21pc2UuZmluYWxseS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmcuanMiOwppbXBvcnQgInJlZ2VuZXJhdG9yLXJ1bnRpbWUvcnVudGltZS5qcyI7CmltcG9ydCBiYWRnZSBmcm9tICdAL3NlcnZpY2VzL2JhZGdlJzsKaW1wb3J0IGJyb3dzZXIgZnJvbSAnQC9zZXJ2aWNlcy9icm93c2VyJzsKaW1wb3J0IHN0b3JhZ2UgZnJvbSAnQC9zZXJ2aWNlcy9zdG9yYWdlJzsKaW1wb3J0IHsgcG9wdXBBY3Rpb25zLCByZWNvcmRpbmdDb250cm9scyB9IGZyb20gJ0Avc2VydmljZXMvY29uc3RhbnRzJzsKaW1wb3J0IHsgb3ZlcmxheUFjdGlvbnMgfSBmcm9tICdAL21vZHVsZXMvb3ZlcmxheS9jb25zdGFudHMnOwppbXBvcnQgeyBoZWFkbGVzc0FjdGlvbnMgfSBmcm9tICdAL21vZHVsZXMvY29kZS1nZW5lcmF0b3IvY29uc3RhbnRzJzsKaW1wb3J0IENvZGVHZW5lcmF0b3IgZnJvbSAnQC9tb2R1bGVzL2NvZGUtZ2VuZXJhdG9yJzsKCnZhciBCYWNrZ3JvdW5kID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICBmdW5jdGlvbiBCYWNrZ3JvdW5kKCkgewogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEJhY2tncm91bmQpOwoKICAgIHRoaXMuX3JlY29yZGluZyA9IFtdOwogICAgdGhpcy5fYm91bmRlZE1lc3NhZ2VIYW5kbGVyID0gbnVsbDsKICAgIHRoaXMuX2JvdW5kZWROYXZpZ2F0aW9uSGFuZGxlciA9IG51bGw7CiAgICB0aGlzLl9ib3VuZGVkV2FpdEhhbmRsZXIgPSBudWxsOwogICAgdGhpcy5vdmVybGF5SGFuZGxlciA9IG51bGw7CiAgICB0aGlzLl9iYWRnZVN0YXRlID0gJyc7CiAgICB0aGlzLl9pc1BhdXNlZCA9IGZhbHNlOwogICAgdGhpcy5fbWVudUlkID0gJ1BVUFBFVEVFUl9SRUNPUkRFUl9DT05URVhUX01FTlUnOwogICAgdGhpcy5fYm91bmRlZE1lbnVIYW5kbGVyID0gbnVsbDsgLy8gU29tZSBldmVudHMgYXJlIHNlbnQgZG91YmxlIG9uIHBhZ2UgbmF2aWdhdGlvbnMgdG8gc2ltcGxpZnkgdGhlIGV2ZW50IHJlY29yZGVyLgogICAgLy8gV2Uga2VlcCBzb21lIHNpbXBsZSBzdGF0ZSB0byBkaXNyZWdhcmQgZXZlbnRzIGlmIG5lZWRlZC4KCiAgICB0aGlzLl9oYXNHb3RvID0gZmFsc2U7CiAgICB0aGlzLl9oYXNWaWV3UG9ydCA9IGZhbHNlOwogIH0KCiAgX2NyZWF0ZUNsYXNzKEJhY2tncm91bmQsIFt7CiAgICBrZXk6ICJpbml0IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBpbml0KCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgY2hyb21lLmV4dGVuc2lvbi5vbkNvbm5lY3QuYWRkTGlzdGVuZXIoZnVuY3Rpb24gKHBvcnQpIHsKICAgICAgICBwb3J0Lm9uTWVzc2FnZS5hZGRMaXN0ZW5lcihmdW5jdGlvbiAobXNnKSB7CiAgICAgICAgICByZXR1cm4gX3RoaXMuaGFuZGxlUG9wdXBNZXNzYWdlKG1zZyk7CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogInN0YXJ0IiwKICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfc3RhcnQgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoKSB7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDI7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5jbGVhblVwKCk7CgogICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgIHRoaXMuX2JhZGdlU3RhdGUgPSAnJzsKICAgICAgICAgICAgICAgIHRoaXMuX2hhc0dvdG8gPSBmYWxzZTsKICAgICAgICAgICAgICAgIHRoaXMuX2hhc1ZpZXdQb3J0ID0gZmFsc2U7CiAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gNzsKICAgICAgICAgICAgICAgIHJldHVybiBicm93c2VyLmluamVjdENvbnRlbnRTY3JpcHQoKTsKCiAgICAgICAgICAgICAgY2FzZSA3OgogICAgICAgICAgICAgICAgdGhpcy50b2dnbGVPdmVybGF5KHsKICAgICAgICAgICAgICAgICAgb3BlbjogdHJ1ZSwKICAgICAgICAgICAgICAgICAgY2xlYXI6IHRydWUKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgdGhpcy5fYm91bmRlZE1lc3NhZ2VIYW5kbGVyID0gdGhpcy5oYW5kbGVNZXNzYWdlLmJpbmQodGhpcyk7CiAgICAgICAgICAgICAgICB0aGlzLl9ib3VuZGVkTmF2aWdhdGlvbkhhbmRsZXIgPSB0aGlzLmhhbmRsZU5hdmlnYXRpb24uYmluZCh0aGlzKTsKCiAgICAgICAgICAgICAgICB0aGlzLl9ib3VuZGVkV2FpdEhhbmRsZXIgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgIHJldHVybiBiYWRnZS53YWl0KCk7CiAgICAgICAgICAgICAgICB9OwoKICAgICAgICAgICAgICAgIHRoaXMub3ZlcmxheUhhbmRsZXIgPSB0aGlzLmhhbmRsZU92ZXJsYXlNZXNzYWdlLmJpbmQodGhpcyk7IC8vIGNocm9tZS5jb250ZXh0TWVudXMuY3JlYXRlKHsKICAgICAgICAgICAgICAgIC8vICAgaWQ6IHRoaXMuX21lbnVJZCwKICAgICAgICAgICAgICAgIC8vICAgdGl0bGU6ICdIZWFkbGVzcyBSZWNvcmRlcicsCiAgICAgICAgICAgICAgICAvLyAgIGNvbnRleHRzOiBbJ2FsbCddLAogICAgICAgICAgICAgICAgLy8gfSkKICAgICAgICAgICAgICAgIC8vIGNocm9tZS5jb250ZXh0TWVudXMuY3JlYXRlKHsKICAgICAgICAgICAgICAgIC8vICAgaWQ6IHRoaXMuX21lbnVJZCArICdTRUxFQ1RPUicsCiAgICAgICAgICAgICAgICAvLyAgIHRpdGxlOiAnQ29weSBTZWxlY3RvcicsCiAgICAgICAgICAgICAgICAvLyAgIHBhcmVudElkOiB0aGlzLl9tZW51SWQsCiAgICAgICAgICAgICAgICAvLyAgIGNvbnRleHRzOiBbJ2FsbCddLAogICAgICAgICAgICAgICAgLy8gfSkKICAgICAgICAgICAgICAgIC8vIHRoaXMuX2JvdW5kZWRNZW51SGFuZGxlciA9IHRoaXMuaGFuZGxlTWVudUludGVyYWN0aW9uLmJpbmQodGhpcykKICAgICAgICAgICAgICAgIC8vIGNocm9tZS5jb250ZXh0TWVudXMub25DbGlja2VkLmFkZExpc3RlbmVyKHRoaXMuX2JvdW5kZWRNZW51SGFuZGxlcikKCiAgICAgICAgICAgICAgICBjaHJvbWUucnVudGltZS5vbk1lc3NhZ2UuYWRkTGlzdGVuZXIodGhpcy5fYm91bmRlZE1lc3NhZ2VIYW5kbGVyKTsKICAgICAgICAgICAgICAgIGNocm9tZS5ydW50aW1lLm9uTWVzc2FnZS5hZGRMaXN0ZW5lcih0aGlzLm92ZXJsYXlIYW5kbGVyKTsKICAgICAgICAgICAgICAgIGNocm9tZS53ZWJOYXZpZ2F0aW9uLm9uQ29tcGxldGVkLmFkZExpc3RlbmVyKHRoaXMuX2JvdW5kZWROYXZpZ2F0aW9uSGFuZGxlcik7CiAgICAgICAgICAgICAgICBjaHJvbWUud2ViTmF2aWdhdGlvbi5vbkJlZm9yZU5hdmlnYXRlLmFkZExpc3RlbmVyKHRoaXMuX2JvdW5kZWRXYWl0SGFuZGxlcik7CiAgICAgICAgICAgICAgICBiYWRnZS5zdGFydCgpOwoKICAgICAgICAgICAgICBjYXNlIDE3OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZSwgdGhpcyk7CiAgICAgIH0pKTsKCiAgICAgIGZ1bmN0aW9uIHN0YXJ0KCkgewogICAgICAgIHJldHVybiBfc3RhcnQuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHN0YXJ0OwogICAgfSgpCiAgfSwgewogICAga2V5OiAic3RvcCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc3RvcCgpIHsKICAgICAgdGhpcy5fYmFkZ2VTdGF0ZSA9IHRoaXMuX3JlY29yZGluZy5sZW5ndGggPiAwID8gJzEnIDogJyc7CiAgICAgIGNocm9tZS5ydW50aW1lLm9uTWVzc2FnZS5yZW1vdmVMaXN0ZW5lcih0aGlzLl9ib3VuZGVkTWVzc2FnZUhhbmRsZXIpOwogICAgICBjaHJvbWUud2ViTmF2aWdhdGlvbi5vbkNvbXBsZXRlZC5yZW1vdmVMaXN0ZW5lcih0aGlzLl9ib3VuZGVkTmF2aWdhdGlvbkhhbmRsZXIpOwogICAgICBjaHJvbWUud2ViTmF2aWdhdGlvbi5vbkJlZm9yZU5hdmlnYXRlLnJlbW92ZUxpc3RlbmVyKHRoaXMuX2JvdW5kZWRXYWl0SGFuZGxlcik7IC8vIGNocm9tZS5jb250ZXh0TWVudXMub25DbGlja2VkLnJlbW92ZUxpc3RlbmVyKHRoaXMuX2JvdW5kZWRNZW51SGFuZGxlcikKCiAgICAgIGJhZGdlLnN0b3AodGhpcy5fYmFkZ2VTdGF0ZSk7CiAgICAgIHN0b3JhZ2Uuc2V0KHsKICAgICAgICByZWNvcmRpbmc6IHRoaXMuX3JlY29yZGluZwogICAgICB9KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJwYXVzZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcGF1c2UoKSB7CiAgICAgIGJhZGdlLnBhdXNlKCk7CiAgICAgIHRoaXMuX2lzUGF1c2VkID0gdHJ1ZTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJ1blBhdXNlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiB1blBhdXNlKCkgewogICAgICBiYWRnZS5zdGFydCgpOwogICAgICB0aGlzLl9pc1BhdXNlZCA9IGZhbHNlOwogICAgfQogIH0sIHsKICAgIGtleTogImNsZWFuVXAiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNsZWFuVXAoKSB7CiAgICAgIHRoaXMuX3JlY29yZGluZyA9IFtdOwogICAgICB0aGlzLl9pc1BhdXNlZCA9IGZhbHNlOwogICAgICBiYWRnZS5yZXNldCgpOwogICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHsKICAgICAgICBjaHJvbWUuc3RvcmFnZS5sb2NhbC5yZW1vdmUoJ3JlY29yZGluZycsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHJldHVybiByZXNvbHZlKCk7CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogInJlY29yZEN1cnJlbnRVcmwiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlY29yZEN1cnJlbnRVcmwoaHJlZikgewogICAgICBpZiAoIXRoaXMuX2hhc0dvdG8pIHsKICAgICAgICB0aGlzLmhhbmRsZU1lc3NhZ2UoewogICAgICAgICAgc2VsZWN0b3I6IHVuZGVmaW5lZCwKICAgICAgICAgIHZhbHVlOiB1bmRlZmluZWQsCiAgICAgICAgICBhY3Rpb246IGhlYWRsZXNzQWN0aW9ucy5HT1RPLAogICAgICAgICAgaHJlZjogaHJlZgogICAgICAgIH0pOwogICAgICAgIHRoaXMuX2hhc0dvdG8gPSB0cnVlOwogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAicmVjb3JkQ3VycmVudFZpZXdwb3J0U2l6ZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcmVjb3JkQ3VycmVudFZpZXdwb3J0U2l6ZSh2YWx1ZSkgewogICAgICBpZiAoIXRoaXMuX2hhc1ZpZXdQb3J0KSB7CiAgICAgICAgdGhpcy5oYW5kbGVNZXNzYWdlKHsKICAgICAgICAgIHNlbGVjdG9yOiB1bmRlZmluZWQsCiAgICAgICAgICB2YWx1ZTogdmFsdWUsCiAgICAgICAgICBhY3Rpb246IGhlYWRsZXNzQWN0aW9ucy5WSUVXUE9SVAogICAgICAgIH0pOwogICAgICAgIHRoaXMuX2hhc1ZpZXdQb3J0ID0gdHJ1ZTsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogInJlY29yZE5hdmlnYXRpb24iLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlY29yZE5hdmlnYXRpb24oKSB7CiAgICAgIHRoaXMuaGFuZGxlTWVzc2FnZSh7CiAgICAgICAgc2VsZWN0b3I6IHVuZGVmaW5lZCwKICAgICAgICB2YWx1ZTogdW5kZWZpbmVkLAogICAgICAgIGFjdGlvbjogaGVhZGxlc3NBY3Rpb25zLk5BVklHQVRJT04KICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAicmVjb3JkU2NyZWVuc2hvdCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcmVjb3JkU2NyZWVuc2hvdCh2YWx1ZSkgewogICAgICB0aGlzLmhhbmRsZU1lc3NhZ2UoewogICAgICAgIHNlbGVjdG9yOiB1bmRlZmluZWQsCiAgICAgICAgdmFsdWU6IHZhbHVlLAogICAgICAgIGFjdGlvbjogaGVhZGxlc3NBY3Rpb25zLlNDUkVFTlNIT1QKICAgICAgfSk7CiAgICB9IC8vIGhhbmRsZU1lbnVJbnRlcmFjdGlvbihpbmZvLCB0YWIpIHsKICAgIC8vIH0KCiAgfSwgewogICAga2V5OiAiaGFuZGxlTWVzc2FnZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gaGFuZGxlTWVzc2FnZShtc2csIHNlbmRlcikgewogICAgICBpZiAobXNnLmNvbnRyb2wpIHsKICAgICAgICByZXR1cm4gdGhpcy5oYW5kbGVSZWNvcmRpbmdNZXNzYWdlKG1zZywgc2VuZGVyKTsKICAgICAgfQoKICAgICAgaWYgKG1zZy50eXBlID09PSAnU0lHTl9DT05ORUNUJykgewogICAgICAgIHJldHVybjsKICAgICAgfSAvLyBOT1RFOiBUbyBhY2NvdW50IGZvciBjbGlja3MgZXRjLiB3ZSBuZWVkIHRvIHJlY29yZCB0aGUgZnJhbWVJZAogICAgICAvLyBhbmQgdXJsIHRvIGxhdGVyIHRhcmdldCB0aGUgZnJhbWUgaW4gcGxheWJhY2sKCgogICAgICBtc2cuZnJhbWVJZCA9IHNlbmRlciA/IHNlbmRlci5mcmFtZUlkIDogbnVsbDsKICAgICAgbXNnLmZyYW1lVXJsID0gc2VuZGVyID8gc2VuZGVyLnVybCA6IG51bGw7CgogICAgICBpZiAoIXRoaXMuX2lzUGF1c2VkKSB7CiAgICAgICAgdGhpcy5fcmVjb3JkaW5nLnB1c2gobXNnKTsKCiAgICAgICAgc3RvcmFnZS5zZXQoewogICAgICAgICAgcmVjb3JkaW5nOiB0aGlzLl9yZWNvcmRpbmcKICAgICAgICB9KTsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogImhhbmRsZU92ZXJsYXlNZXNzYWdlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfaGFuZGxlT3ZlcmxheU1lc3NhZ2UgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUyKF9yZWYpIHsKICAgICAgICB2YXIgY29udHJvbCwgX29wdGlvbnMkY29kZSwgX3lpZWxkJHN0b3JhZ2UkZ2V0LCBfeWllbGQkc3RvcmFnZSRnZXQkb3AsIG9wdGlvbnMsIGdlbmVyYXRvciwgY29kZTsKCiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUyJChfY29udGV4dDIpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQyLnByZXYgPSBfY29udGV4dDIubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIGNvbnRyb2wgPSBfcmVmLmNvbnRyb2w7CgogICAgICAgICAgICAgICAgaWYgKGNvbnRyb2wpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAzOwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICAgIGlmIChjb250cm9sID09PSBvdmVybGF5QWN0aW9ucy5SRVNUQVJUKSB7CiAgICAgICAgICAgICAgICAgIGNocm9tZS5zdG9yYWdlLmxvY2FsLnNldCh7CiAgICAgICAgICAgICAgICAgICAgcmVzdGFydDogdHJ1ZQogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgY2hyb21lLnN0b3JhZ2UubG9jYWwuc2V0KHsKICAgICAgICAgICAgICAgICAgICBjbGVhcjogZmFsc2UKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgIGNocm9tZS5ydW50aW1lLm9uTWVzc2FnZS5yZW1vdmVMaXN0ZW5lcih0aGlzLm92ZXJsYXlIYW5kbGVyKTsKICAgICAgICAgICAgICAgICAgdGhpcy5zdG9wKCk7CiAgICAgICAgICAgICAgICAgIHRoaXMuY2xlYW5VcCgpOwogICAgICAgICAgICAgICAgICB0aGlzLnN0YXJ0KCk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgaWYgKGNvbnRyb2wgPT09IG92ZXJsYXlBY3Rpb25zLkNMT1NFKSB7CiAgICAgICAgICAgICAgICAgIHRoaXMudG9nZ2xlT3ZlcmxheSgpOwogICAgICAgICAgICAgICAgICBjaHJvbWUucnVudGltZS5vbk1lc3NhZ2UucmVtb3ZlTGlzdGVuZXIodGhpcy5vdmVybGF5SGFuZGxlcik7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgaWYgKCEoY29udHJvbCA9PT0gb3ZlcmxheUFjdGlvbnMuQ09QWSkpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAxNDsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSA4OwogICAgICAgICAgICAgICAgcmV0dXJuIHN0b3JhZ2UuZ2V0KCdvcHRpb25zJyk7CgogICAgICAgICAgICAgIGNhc2UgODoKICAgICAgICAgICAgICAgIF95aWVsZCRzdG9yYWdlJGdldCA9IF9jb250ZXh0Mi5zZW50OwogICAgICAgICAgICAgICAgX3lpZWxkJHN0b3JhZ2UkZ2V0JG9wID0gX3lpZWxkJHN0b3JhZ2UkZ2V0Lm9wdGlvbnM7CiAgICAgICAgICAgICAgICBvcHRpb25zID0gX3lpZWxkJHN0b3JhZ2UkZ2V0JG9wID09PSB2b2lkIDAgPyB7fSA6IF95aWVsZCRzdG9yYWdlJGdldCRvcDsKICAgICAgICAgICAgICAgIGdlbmVyYXRvciA9IG5ldyBDb2RlR2VuZXJhdG9yKG9wdGlvbnMpOwogICAgICAgICAgICAgICAgY29kZSA9IGdlbmVyYXRvci5nZW5lcmF0ZSh0aGlzLl9yZWNvcmRpbmcpOwogICAgICAgICAgICAgICAgYnJvd3Nlci5zZW5kVGFiTWVzc2FnZSh7CiAgICAgICAgICAgICAgICAgIGFjdGlvbjogJ0NPREUnLAogICAgICAgICAgICAgICAgICB2YWx1ZTogb3B0aW9ucyAhPT0gbnVsbCAmJiBvcHRpb25zICE9PSB2b2lkIDAgJiYgKF9vcHRpb25zJGNvZGUgPSBvcHRpb25zLmNvZGUpICE9PSBudWxsICYmIF9vcHRpb25zJGNvZGUgIT09IHZvaWQgMCAmJiBfb3B0aW9ucyRjb2RlLnNob3dQbGF5d3JpZ2h0Rmlyc3QgPyBjb2RlLnBsYXl3cmlnaHQgOiBjb2RlLnB1cHBldGVlcgogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgIGNhc2UgMTQ6CiAgICAgICAgICAgICAgICBpZiAoY29udHJvbCA9PT0gb3ZlcmxheUFjdGlvbnMuU1RPUCkgewogICAgICAgICAgICAgICAgICBjaHJvbWUuc3RvcmFnZS5sb2NhbC5zZXQoewogICAgICAgICAgICAgICAgICAgIGNsZWFyOiB0cnVlCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICBjaHJvbWUuc3RvcmFnZS5sb2NhbC5zZXQoewogICAgICAgICAgICAgICAgICAgIHBhdXNlOiBmYWxzZQogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgY2hyb21lLnN0b3JhZ2UubG9jYWwuc2V0KHsKICAgICAgICAgICAgICAgICAgICByZXN0YXJ0OiBmYWxzZQogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgdGhpcy5zdG9wKCk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgaWYgKGNvbnRyb2wgPT09IG92ZXJsYXlBY3Rpb25zLlVOUEFVU0UpIHsKICAgICAgICAgICAgICAgICAgY2hyb21lLnN0b3JhZ2UubG9jYWwuc2V0KHsKICAgICAgICAgICAgICAgICAgICBwYXVzZTogZmFsc2UKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgIHRoaXMudW5QYXVzZSgpOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGlmIChjb250cm9sID09PSBvdmVybGF5QWN0aW9ucy5QQVVTRSkgewogICAgICAgICAgICAgICAgICBjaHJvbWUuc3RvcmFnZS5sb2NhbC5zZXQoewogICAgICAgICAgICAgICAgICAgIHBhdXNlOiB0cnVlCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICB0aGlzLnBhdXNlKCk7CiAgICAgICAgICAgICAgICB9IC8vIFRPRE86IHRoZSBuZXh0IDMgZXZlbnRzIGRvIG5vdCBuZWVkIHRvIGJlIGxpc3RlbmVkIGluIGJhY2tncm91bmQKICAgICAgICAgICAgICAgIC8vIGNvbnRlbnQgc2NyaXB0IGNvbnRyb2xsZXIsIHNob3VsZCBiZSBhYmxlIHRvIGhhbmRsZSB0aGF0IGRpcmVjdGx5IGZyb20gb3ZlcmxheQoKCiAgICAgICAgICAgICAgICBpZiAoY29udHJvbCA9PT0gb3ZlcmxheUFjdGlvbnMuQ0xJUFBFRF9TQ1JFRU5TSE9UKSB7CiAgICAgICAgICAgICAgICAgIGJyb3dzZXIuc2VuZFRhYk1lc3NhZ2UoewogICAgICAgICAgICAgICAgICAgIGFjdGlvbjogb3ZlcmxheUFjdGlvbnMuVE9HR0xFX1NDUkVFTlNIT1RfQ0xJUFBFRF9NT0RFCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGlmIChjb250cm9sID09PSBvdmVybGF5QWN0aW9ucy5GVUxMX1NDUkVFTlNIT1QpIHsKICAgICAgICAgICAgICAgICAgYnJvd3Nlci5zZW5kVGFiTWVzc2FnZSh7CiAgICAgICAgICAgICAgICAgICAgYWN0aW9uOiBvdmVybGF5QWN0aW9ucy5UT0dHTEVfU0NSRUVOU0hPVF9NT0RFCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGlmIChjb250cm9sID09PSBvdmVybGF5QWN0aW9ucy5BQk9SVF9TQ1JFRU5TSE9UKSB7CiAgICAgICAgICAgICAgICAgIGJyb3dzZXIuc2VuZFRhYk1lc3NhZ2UoewogICAgICAgICAgICAgICAgICAgIGFjdGlvbjogb3ZlcmxheUFjdGlvbnMuQ0xPU0VfU0NSRUVOU0hPVF9NT0RFCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBjYXNlIDIwOgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUyLCB0aGlzKTsKICAgICAgfSkpOwoKICAgICAgZnVuY3Rpb24gaGFuZGxlT3ZlcmxheU1lc3NhZ2UoX3gpIHsKICAgICAgICByZXR1cm4gX2hhbmRsZU92ZXJsYXlNZXNzYWdlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH0KCiAgICAgIHJldHVybiBoYW5kbGVPdmVybGF5TWVzc2FnZTsKICAgIH0oKQogIH0sIHsKICAgIGtleTogImhhbmRsZVJlY29yZGluZ01lc3NhZ2UiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGhhbmRsZVJlY29yZGluZ01lc3NhZ2UoX3JlZjIpIHsKICAgICAgdmFyIGNvbnRyb2wgPSBfcmVmMi5jb250cm9sLAogICAgICAgICAgaHJlZiA9IF9yZWYyLmhyZWYsCiAgICAgICAgICB2YWx1ZSA9IF9yZWYyLnZhbHVlLAogICAgICAgICAgY29vcmRpbmF0ZXMgPSBfcmVmMi5jb29yZGluYXRlczsKCiAgICAgIGlmIChjb250cm9sID09PSByZWNvcmRpbmdDb250cm9scy5FVkVOVF9SRUNPUkRFUl9TVEFSVEVEKSB7CiAgICAgICAgYmFkZ2Uuc2V0VGV4dCh0aGlzLl9iYWRnZVN0YXRlKTsKICAgICAgfQoKICAgICAgaWYgKGNvbnRyb2wgPT09IHJlY29yZGluZ0NvbnRyb2xzLkdFVF9WSUVXUE9SVF9TSVpFKSB7CiAgICAgICAgdGhpcy5yZWNvcmRDdXJyZW50Vmlld3BvcnRTaXplKGNvb3JkaW5hdGVzKTsKICAgICAgfQoKICAgICAgaWYgKGNvbnRyb2wgPT09IHJlY29yZGluZ0NvbnRyb2xzLkdFVF9DVVJSRU5UX1VSTCkgewogICAgICAgIHRoaXMucmVjb3JkQ3VycmVudFVybChocmVmKTsKICAgICAgfQoKICAgICAgaWYgKGNvbnRyb2wgPT09IHJlY29yZGluZ0NvbnRyb2xzLkdFVF9TQ1JFRU5TSE9UKSB7CiAgICAgICAgdGhpcy5yZWNvcmRTY3JlZW5zaG90KHZhbHVlKTsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogImhhbmRsZVBvcHVwTWVzc2FnZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gaGFuZGxlUG9wdXBNZXNzYWdlKG1zZykgewogICAgICBpZiAoIW1zZy5hY3Rpb24pIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGlmIChtc2cuYWN0aW9uID09PSBwb3B1cEFjdGlvbnMuU1RBUlQpIHsKICAgICAgICB0aGlzLnN0YXJ0KCk7CiAgICAgIH0KCiAgICAgIGlmIChtc2cuYWN0aW9uID09PSBwb3B1cEFjdGlvbnMuU1RPUCkgewogICAgICAgIGJyb3dzZXIuc2VuZFRhYk1lc3NhZ2UoewogICAgICAgICAgYWN0aW9uOiBwb3B1cEFjdGlvbnMuU1RPUAogICAgICAgIH0pOwogICAgICAgIHRoaXMuc3RvcCgpOwogICAgICB9CgogICAgICBpZiAobXNnLmFjdGlvbiA9PT0gcG9wdXBBY3Rpb25zLkNMRUFOX1VQKSB7CiAgICAgICAgY2hyb21lLnJ1bnRpbWUub25NZXNzYWdlLnJlbW92ZUxpc3RlbmVyKHRoaXMub3ZlcmxheUhhbmRsZXIpOwogICAgICAgIG1zZy52YWx1ZSAmJiB0aGlzLnN0b3AoKTsKICAgICAgICB0aGlzLnRvZ2dsZU92ZXJsYXkoKTsKICAgICAgICB0aGlzLmNsZWFuVXAoKTsKICAgICAgfQoKICAgICAgaWYgKG1zZy5hY3Rpb24gPT09IHBvcHVwQWN0aW9ucy5QQVVTRSkgewogICAgICAgIGlmICghbXNnLnN0b3ApIHsKICAgICAgICAgIGJyb3dzZXIuc2VuZFRhYk1lc3NhZ2UoewogICAgICAgICAgICBhY3Rpb246IHBvcHVwQWN0aW9ucy5QQVVTRQogICAgICAgICAgfSk7CiAgICAgICAgfQoKICAgICAgICB0aGlzLnBhdXNlKCk7CiAgICAgIH0KCiAgICAgIGlmIChtc2cuYWN0aW9uID09PSBwb3B1cEFjdGlvbnMuVU5fUEFVU0UpIHsKICAgICAgICBpZiAoIW1zZy5zdG9wKSB7CiAgICAgICAgICBicm93c2VyLnNlbmRUYWJNZXNzYWdlKHsKICAgICAgICAgICAgYWN0aW9uOiBwb3B1cEFjdGlvbnMuVU5fUEFVU0UKICAgICAgICAgIH0pOwogICAgICAgIH0KCiAgICAgICAgdGhpcy51blBhdXNlKCk7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICJoYW5kbGVOYXZpZ2F0aW9uIiwKICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfaGFuZGxlTmF2aWdhdGlvbiA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTMoX3JlZjMpIHsKICAgICAgICB2YXIgZnJhbWVJZDsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTMkKF9jb250ZXh0MykgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDMucHJldiA9IF9jb250ZXh0My5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgZnJhbWVJZCA9IF9yZWYzLmZyYW1lSWQ7CiAgICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDM7CiAgICAgICAgICAgICAgICByZXR1cm4gYnJvd3Nlci5pbmplY3RDb250ZW50U2NyaXB0KCk7CgogICAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICAgIHRoaXMudG9nZ2xlT3ZlcmxheSh7CiAgICAgICAgICAgICAgICAgIG9wZW46IHRydWUsCiAgICAgICAgICAgICAgICAgIHBhdXNlOiB0aGlzLl9pc1BhdXNlZAogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgaWYgKGZyYW1lSWQgPT09IDApIHsKICAgICAgICAgICAgICAgICAgdGhpcy5yZWNvcmROYXZpZ2F0aW9uKCk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGNhc2UgNToKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0My5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlMywgdGhpcyk7CiAgICAgIH0pKTsKCiAgICAgIGZ1bmN0aW9uIGhhbmRsZU5hdmlnYXRpb24oX3gyKSB7CiAgICAgICAgcmV0dXJuIF9oYW5kbGVOYXZpZ2F0aW9uLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH0KCiAgICAgIHJldHVybiBoYW5kbGVOYXZpZ2F0aW9uOwogICAgfSgpIC8vIFRPRE86IFVzZSBhIGJldHRlciBuYW1pbmcgY29udmVudGlvbiBmb3IgdGhpcyBhcmd1bWVudHMKCiAgfSwgewogICAga2V5OiAidG9nZ2xlT3ZlcmxheSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gdG9nZ2xlT3ZlcmxheSgpIHsKICAgICAgdmFyIF9yZWY0ID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiB7fSwKICAgICAgICAgIF9yZWY0JG9wZW4gPSBfcmVmNC5vcGVuLAogICAgICAgICAgb3BlbiA9IF9yZWY0JG9wZW4gPT09IHZvaWQgMCA/IGZhbHNlIDogX3JlZjQkb3BlbiwKICAgICAgICAgIF9yZWY0JGNsZWFyID0gX3JlZjQuY2xlYXIsCiAgICAgICAgICBjbGVhciA9IF9yZWY0JGNsZWFyID09PSB2b2lkIDAgPyBmYWxzZSA6IF9yZWY0JGNsZWFyLAogICAgICAgICAgX3JlZjQkcGF1c2UgPSBfcmVmNC5wYXVzZSwKICAgICAgICAgIHBhdXNlID0gX3JlZjQkcGF1c2UgPT09IHZvaWQgMCA/IGZhbHNlIDogX3JlZjQkcGF1c2U7CgogICAgICBicm93c2VyLnNlbmRUYWJNZXNzYWdlKHsKICAgICAgICBhY3Rpb246IG92ZXJsYXlBY3Rpb25zLlRPR0dMRV9PVkVSTEFZLAogICAgICAgIHZhbHVlOiB7CiAgICAgICAgICBvcGVuOiBvcGVuLAogICAgICAgICAgY2xlYXI6IGNsZWFyLAogICAgICAgICAgcGF1c2U6IHBhdXNlCiAgICAgICAgfQogICAgICB9KTsKICAgIH0KICB9XSk7CgogIHJldHVybiBCYWNrZ3JvdW5kOwp9KCk7Cgp3aW5kb3cuaGVhZGxlc3NSZWNvcmRlciA9IG5ldyBCYWNrZ3JvdW5kKCk7CndpbmRvdy5oZWFkbGVzc1JlY29yZGVyLmluaXQoKTs="},null]}